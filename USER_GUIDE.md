# 📖 NotebookLM Enhancer 操作手冊 (User Guide)

歡迎使用 **NotebookLM Enhancer**！本工具能協助您將 Google NotebookLM 生成的 PDF 簡報轉換為高品質、可編輯的 PowerPoint (PPTX) 檔案，並修復模糊文字與移除浮水印。

---

## 🚀 快速開始 (Quick Start)

### 步驟 1：使用者登入 (Login)
為了記錄使用情況，請先輸入您的姓名或部門。
1.  在主畫面最上方，找到 **"👤 使用者登入 (User Login)"** 區塊。
2.  輸入您的姓名 (例如：`王小明 (研發部)`)。
3.  輸入後，下方的上傳區塊才會出現。

### 步驟 2：上傳檔案 (Upload)
1.  在 **"📂 上傳 PDF (Upload PDF)"** 區域。
2.  點擊 **"Browse files"** 按鈕，選擇您從 NotebookLM 下載的 PDF 檔案。
    *   *支援格式：PDF*
    *   *建議大小：小於 200MB*

### 步驟 2：預覽頁面 (Preview)
檔案上傳成功後，主畫面會自動顯示第一頁的預覽圖。
*   **👀 預覽所有頁面**：點擊主畫面下方的 **"👀 預覽所有頁面 (Preview All Pages)"** 展開區塊，即可一次瀏覽所有投影片的縮圖。
*   **🗑️ 刪除頁面**：在每個縮圖下方都有一個 **"🗑️ 刪除 (Delete)"** 勾選框。若您勾選了某些頁面，這些頁面將**不會**出現在最終生成的 PDF 或 PPTX 中。系統會顯示警告訊息提示您即將刪除的頁數。

### 步驟 3：文字校對 (Edit Text) - *選用*
如果您發現 PDF 中的文字模糊或辨識錯誤，可以使用此功能進行修正。
1.  點擊上方的 **"✏️ 編輯文字 (Edit Text)"** 分頁 (Tab)。
2.  您會看到一個表格，列出了每一頁偵測到的文字內容。
3.  **直接修改**表格中的文字：
    *   修正錯字。
    *   刪除多餘的雜訊文字。
4.  修改完成後，程式會自動儲存您的變更，並應用於最終的 PPTX 輸出。

### 步驟 4：設定選項 (Settings)
在左側邊欄下方，您可以調整處理參數：

#### 💧 浮水印移除 (Watermark Removal)
*   **去除浮水印 (Remove Watermark)**：預設開啟。
*   **模式選擇**：
    *   **鏡像修補 (Mirror Patch)**：*推薦*。複製對稱位置的背景來填補浮水印，效果最自然。
    *   **純色遮蓋 (White Mask)**：用白色方塊遮蓋浮水印，適合純白背景。
    *   **手動修補 (Manual Patch)**：進階使用者專用，可自訂修補來源座標。

#### 🅰️ 字型設定 (Font Settings)
*   **字型路徑**：預設使用 `fonts/msjh.ttc` (微軟正黑體)。若伺服器上無此字型，將使用系統預設字型。

#### 🎨 PPTX 轉換模式 (PPTX Conversion Mode)
*   **重繪模式 (Re-render)**：*預設推薦*。
    *   程式會嘗試將原始 PDF 上的文字「抹除」(模糊化)，然後將 OCR 辨識出的文字重新繪製上去。
    *   **優點**：背景最乾淨，文字最清晰可編輯。
    *   **缺點**：如果背景很複雜，抹除文字時可能會留下痕跡。
*   **疊加模式 (Overlay)**：
    *   保留原始 PDF 的完整背景 (含原始文字)，然後將 OCR 辨識出的文字以「透明/隱形」的方式疊加在上面。
    *   **優點**：100% 保留原始排版與設計。
    *   **缺點**：雖然文字可選取，但視覺上還是原始的圖片文字，無法直接修改字體樣式 (除非您刪除背景圖)。

### 步驟 5：開始轉換 (Convert & Download)
1.  確認設定無誤後，點擊左側邊欄的 **"🚀 開始處理 (Process PDF)"** 按鈕。
2.  系統會開始逐頁處理：
    *   增強畫質
    *   移除浮水印
    *   執行 OCR 文字辨識 (若有需要)
    *   生成 PPTX
3.  處理完成後，畫面會出現 **"🎉 處理完成! (Processing Complete!)"** 訊息。
4.  點擊出現的 **"📥 下載 PPTX (Download PPTX)"** 按鈕，即可將檔案儲存到您的電腦。

---

## 💡 常見問題 (FAQ)

**Q: 為什麼轉換速度有點慢？**
A: 為了確保最佳畫質與文字可編輯性，程式會對每一頁進行高解析度渲染與 OCR 辨識。若使用 Streamlit Cloud 免費版，因運算資源有限，處理速度會受限。建議分批處理較大的檔案。

**Q: 轉換後的 PPTX 文字位置有點跑掉？**
A: 這是正常的。OCR 技術雖然強大，但無法 100% 完美還原複雜排版。您可以在下載 PPTX 後，於 PowerPoint 中微調文字方塊的位置。

**Q: 出現 "Illegal instruction" 錯誤？**
A: 請確認您使用的是最新版本的應用程式 (已升級為 RapidOCR 引擎)。舊版程式碼在某些雲端環境下會發生此錯誤。

---
*祝您使用愉快！*
